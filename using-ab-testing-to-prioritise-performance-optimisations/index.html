<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1"> <meta name="theme-color" content="#8e44ad"> <title>Using A/B testing to prioritise performance optimisations | Wildly Inaccurate</title> <meta name="description" content="Back in December 2015 I spoke at LDNWebPerf alongside Peter Chamberlin about how web performance is not a technical problem (slides with speaker notes). One of the things I talked about was how we used multivariate testing (MVT) at BBC News to pri..."> <meta property="og:title" content="Using A/B testing to prioritise performance optimisations"> <meta property="og:description" content="Back in December 2015 I spoke at LDNWebPerf alongside Peter Chamberlin about how web performance is not a technical problem (slides with speaker notes). One of the things I talked about was how we used multivariate testing (MVT) at BBC News to pri..."> <meta property="og:image" content="https://wildlyinaccurate.com/assets/dfi.jpg"> <style>img,svg{vertical-align:middle}ol,p,pre,table,ul{margin-bottom:1rem}a,table{background-color:transparent}ol,p,pre,ul{margin-top:0}#carbonads,article,footer,header,nav,section{display:block}a:active,a:hover{outline-width:0}svg:not(:root){overflow:hidden}*,::after,::before{box-sizing:border-box}html{font-family:sans-serif;line-height:1.15;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;-ms-overflow-style:scrollbar;-webkit-tap-highlight-color:transparent}@-ms-viewport{width:device-width}body{margin:0;font-family:serif;font-size:1.12rem;font-weight:400;line-height:1.5;color:#212529;text-align:left;background-color:#fff}ul ul{margin-bottom:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:80%}a{color:#7700a8;text-decoration:none;-webkit-text-decoration-skip:objects}a:hover{color:#41005c;text-decoration:underline}code,pre{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}pre{overflow:auto;-ms-overflow-style:scrollbar;padding:1rem}img{border-style:none;max-width:100%;height:auto}svg{overflow:hidden}table{border-collapse:collapse;width:100%}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}.btn,h1,h2,h3,h4,h5{font-family:sans-serif}h1,h2,h3,h4,h5{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2;color:inherit}h1{font-size:2.8rem}h2{font-size:2.24rem}h3{font-size:1.848rem}h4{font-size:1.68rem}h5{font-size:1.4rem}small{font-weight:400}table td{padding:.75rem;vertical-align:top}table,table td{border:1px solid #dee2e6}#carbonads{margin:1rem auto;max-width:200px}.mb-4,.my-4{margin-bottom:1.5rem}.carbon-poweredby,.carbon-text{color:#6c757d;display:block;margin-top:.5rem}.btn,.d-ib{display:inline-block}blockquote{border-left:5px solid #7700a8;padding:1rem 2rem 1px}.btn{background:#7700a8;color:#fff}.btn:focus,.btn:hover{background:rgba(119,0,168,.8);color:#fff}.btn--inverse{background:rgba(255,255,255,.67);color:#7700a8}.btn--inverse:focus,.btn--inverse:hover{background:rgba(255,255,255,.4)}code,pre{background:#f8f9fa;font-size:87.5%}code{padding:.3333333333rem .5rem;white-space:pre-wrap}pre code{padding:0}[class*=language-] pre,[class*=language-] pre code{background:#212529}footer{border-top:1px solid #6c757d}.post-content>*,.wrap{width:100%;padding-right:15px;padding-left:15px;margin-right:auto;margin-left:auto;max-width:960px;max-width:1140px}@media (min-width:576px){.post-content>*,.wrap{max-width:540px}}@media (min-width:768px){.post-content>*,.wrap{max-width:720px}}.post-content>ol,.post-content>ul{padding-left:45px}.outset{width:1280px;max-width:90%}@media (max-width:767.98px){.outset{max-width:100%}}.ls-n{list-style:none}h2{margin-top:1.5rem}h3{margin-top:1rem}.page-header{color:#fff;min-height:240px;overflow:hidden;position:relative;text-shadow:-1px 0 1px #000}.page-header a{color:#fff}.va-m{vertical-align:middle}.c-gl{color:#6c757d}.z-1{z-index:1}.z--1{z-index:-1}.f-r{float:right}.pos-a{position:absolute}.b-0{bottom:0}.h-100{height:100%}.h-4{height:1.5rem}.w-100{width:100%}.w-4{width:1.5rem}@media (min-width:768px){.h-md-a{height:auto}}.mw-w{max-width:880px}.mw-n{max-width:none}.my-4{margin-top:1.5rem}.mt-5{margin-top:3rem}.p-2{padding:.5rem}.pt-2{padding-top:.5rem}.p-3{padding:1rem}.pb-3{padding-bottom:1rem}.pt-4{padding-top:1.5rem}.pt-5{padding-top:3rem}@media (min-width:576px){.p-sm-3{padding:1rem}}.ta-c{text-align:center}</style> <link rel="manifest" href="/manifest.json"> <link rel="canonical" href="https://wildlyinaccurate.com/using-ab-testing-to-prioritise-performance-optimisations"> <link rel="alternate" type="application/atom+xml" title="Wildly Inaccurate" href="https://wildlyinaccurate.com/feed.xml"> </head> <body> <nav class="pos-a w-100 z-1"> <div class="wrap mw-w"> <a class="btn p-2 p-sm-3" href="https://wildlyinaccurate.com">Wildly Inaccurate</a> <div class="f-r"> <a class="btn btn--inverse p-2 p-sm-3" href="/about/">About</a> <a class="btn btn--inverse p-2 p-sm-3" href="/projects/">Projects</a> <a class="btn btn--inverse p-2 p-sm-3" href="/search/">Search</a> </div> </div> </nav> <header class="page-header mb-4"> <img class="pos-a b-0 h-100 mw-n h-md-a z--1" src="/assets/dfi.jpg" srcset="/assets/r/330/dfi.jpg 330w, /assets/r/345/dfi.jpg 345w, /assets/r/381/dfi.jpg 381w, /assets/r/384/dfi.jpg 384w, /assets/r/546/dfi.jpg 546w, /assets/r/640/dfi.jpg 640w, /assets/r/738/dfi.jpg 738w, /assets/r/840/dfi.jpg 840w, /assets/r/960/dfi.jpg 960w, /assets/r/1250/dfi.jpg 1250w, /assets/r/1366/dfi.jpg 1366w, /assets/r/1440/dfi.jpg 1440w, /assets/r/1680/dfi.jpg 1680w, /assets/dfi.jpg 2600w"> <div class="wrap mw-w mt-5 pt-2"> <h1 class="mt-5">Using A/B testing to prioritise performance optimisations</h1> <p class="pt-2 pt-lg-4"> May 20, 2016 &#x2022; 5 minute read &#x2022; posted in [ <a href="/category/BBC News/">BBC News</a>, <a href="/category/Performance/">Performance</a> ] </p> </div> </header> <article class="post-content"> <p>Back in December 2015 I spoke at LDNWebPerf alongside Peter Chamberlin about how <a href="https://www.youtube.com/watch?v=nE4LTRfcr94">web performance is not a technical problem</a> <small>(<a href="http://slides.com/wildlyinaccurate/bbc-news-performance#/">slides with speaker notes</a>)</small>. One of the things I talked about was how we used multivariate testing (MVT) at BBC News to prioritise performance optimisations. The gist of it was that our stakeholders had already bought into the idea that performance has a strong correlation to business metrics, and they wanted to dedicate some development time to improving performance. The catch was that they didn&#x2019;t want to spent <em>too much</em> time on it.</p> <p>Our predicament, then, was that we needed to know which optimisations had the biggest impact on performance without actually spending the time to make the optimisations. For example, we had a hunch that inlining the <a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/">critical rendering path</a> CSS would improve our start render time, but with over 1MB of CSS and a complicated application architecture, implementing this was much easier said than done.</p> <p>This is where the idea to A/B test performance came from: we could easily make the performance optimisations by hand on a single page, and then benchmark each of the optimisations to find out which had the biggest impact.<!--more--></p> <h2 id="the-method">The method</h2> <p>Setting up A/B tests for performance is much simpler than you might think &#x2014; all you need is a page to use as the baseline, a page for each optimisation, and a consistent way to measure performance.</p> <p>We took a snapshot of the BBC News front page to use as the baseline, and made a variation of that snapshot by hand for each performance optimisation. The focus of this post isn&#x2019;t the optimisations themselves, but to give some context, they were things like:</p> <ul> <li>Lazy loading images below the fold.</li> <li>Delaying JavaScript execution until after the content has rendered.</li> <li>Removing unused CSS.</li> <li>Loading adverts asynchronously.</li> </ul> <div class="my-4 ta-c outset"> <img alt="Some of the hand-made performance optimisations" src="/assets/bbc-news-performance-mvt.png" width="778" srcset="/assets/r/330/bbc-news-performance-mvt.png 330w, /assets/r/345/bbc-news-performance-mvt.png 345w, /assets/r/381/bbc-news-performance-mvt.png 381w, /assets/r/384/bbc-news-performance-mvt.png 384w, /assets/r/546/bbc-news-performance-mvt.png 546w, /assets/r/640/bbc-news-performance-mvt.png 640w, /assets/r/738/bbc-news-performance-mvt.png 738w, /assets/bbc-news-performance-mvt.png 778w"> <div class="c-gl caption"> <small><i>Some of the hand-made performance optimisations</i></small> </div> </div> <p>We deployed these optimised variations alongside the baseline, and used <a href="https://www.webpagetest.org/">WebPagetest</a> to benchmark their performance. If you&#x2019;re not familiar with WebPagetest, it&#x2019;s a really useful tool to have in your web performance toolkit. It loads a page in real web browsers and records information about its performance. It has a bunch of useful features like connection throttling, video capture, and also lets you script interaction with the page.</p> <div class="my-4 ta-c outset"> <img alt="The WebPagetest interface" src="/assets/webpagetest.png" width="995" srcset="/assets/r/330/webpagetest.png 330w, /assets/r/345/webpagetest.png 345w, /assets/r/381/webpagetest.png 381w, /assets/r/384/webpagetest.png 384w, /assets/r/546/webpagetest.png 546w, /assets/r/640/webpagetest.png 640w, /assets/r/738/webpagetest.png 738w, /assets/r/840/webpagetest.png 840w, /assets/r/960/webpagetest.png 960w, /assets/webpagetest.png 995w"> <div class="c-gl caption"> <small><i>The WebPagetest interface</i></small> </div> </div> <p>One of the other features that WebPagetest offers is the ability to visually compare two pages. We used this a lot while we were benchmarking the variations because it&#x2019;s great way to show the impact of optimisations to non-technical stakeholders.</p> <div class="my-4 ta-c outset"> <img alt="Visual comparison of the baseline snapshot against an optimised variation" src="/assets/bbc-news-mvt-optimised-css.png" srcset="/assets/r/330/bbc-news-mvt-optimised-css.png 330w, /assets/r/345/bbc-news-mvt-optimised-css.png 345w, /assets/r/381/bbc-news-mvt-optimised-css.png 381w, /assets/r/384/bbc-news-mvt-optimised-css.png 384w, /assets/r/546/bbc-news-mvt-optimised-css.png 546w, /assets/r/640/bbc-news-mvt-optimised-css.png 640w, /assets/r/738/bbc-news-mvt-optimised-css.png 738w, /assets/r/840/bbc-news-mvt-optimised-css.png 840w, /assets/r/960/bbc-news-mvt-optimised-css.png 960w, /assets/r/1250/bbc-news-mvt-optimised-css.png 1250w"> <div class="c-gl caption"> <small><i>Visual comparison of the baseline snapshot against an optimised variation</i></small> </div> </div> <h2 id="interpreting-the-results">Interpreting the results</h2> <p>Interpreting the results of A/B tests is usually very circumstantial and requires some forethought about your own goals and circumstances. Our goal was to identify which performance optimisations gave us the largest improvement to start render time relative to how long they took to implement. We chose this goal because data from our real user monitoring (RUM) suggested there was a strong correlation between start render time and business metrics like bounce rate, session length, and pages per session. Your goal will likely be completely different.</p> <p>To simplify the decision making process, we came up with a scoring system that works by multiplying the improvement to start render time by a difficulty rating:</p> <table> <thead> <tr> <th>Optimisation</th> <th>SR improvement (ms)</th> <th>Difficulty<br>(1 = hardest; 10 = easiest)</th> <th>Score</th> </tr> </thead> <tbody> <tr> <td>Only load JS required for page</td> <td>250</td> <td>8</td> <td><strong>2000</strong></td> </tr> <tr> <td>Only load CSS required for page</td> <td>1000</td> <td>2</td> <td><strong>2000</strong></td> </tr> <tr> <td>Remove blocking scripts from &lt;head&gt;</td> <td>1500</td> <td>1</td> <td><strong>1500</strong></td> </tr> <tr> <td>Lazy load images below the fold</td> <td>80</td> <td>10</td> <td><strong>800</strong></td> </tr> </tbody> </table> <p>It&#x2019;s by no means a perfect system, but it did help us to prioritise the optimisations. There are many other factors that come into play, for example lazy loading images is one of the first optimisations we made, despite it having a low score. The rationale behind this was that it was very easy to do and had a noticeable real-world benefit: it reduced the amount of data for users on mobile connections.</p> <h2 id="validating-the-results">Validating the results</h2> <p>The final part of an A/B test is to validate whether the variants had the predicted impact in real world conditions. For performance optimisations, this is best done using real user monitoring like <a href="https://speedcurve.com/features/lux/">SpeedCurve LUX</a> or <a href="https://www.soasta.com/performance-monitoring/">SOASTA mPulse</a>. However synthetic testing tools like WebPagetest can also work to validate your optimisations.</p> <p>We plotted our performance and business metrics around the time that our optimisations were deployed, and (thankfully) saw the results that we expected.</p> <div class="my-4 ta-c outset"> <img alt="A chart showing a reduction in page load time and an increase in session length" src="/assets/bbc-news-mvt-session-length-vs-load-time.png" width="830" srcset="/assets/r/330/bbc-news-mvt-session-length-vs-load-time.png 330w, /assets/r/345/bbc-news-mvt-session-length-vs-load-time.png 345w, /assets/r/381/bbc-news-mvt-session-length-vs-load-time.png 381w, /assets/r/384/bbc-news-mvt-session-length-vs-load-time.png 384w, /assets/r/546/bbc-news-mvt-session-length-vs-load-time.png 546w, /assets/r/640/bbc-news-mvt-session-length-vs-load-time.png 640w, /assets/r/738/bbc-news-mvt-session-length-vs-load-time.png 738w, /assets/bbc-news-mvt-session-length-vs-load-time.png 830w"> <div class="c-gl caption"> <small><i>A chart showing a reduction in page load time and an increase in session length</i></small> </div> </div> <div class="my-4 ta-c outset"> <img alt="A chart showing a reduction in load time, DOM ready time, and DOM content loaded time" src="/assets/bbc-news-mvt-dom-metrics.png" srcset="/assets/r/330/bbc-news-mvt-dom-metrics.png 330w, /assets/r/345/bbc-news-mvt-dom-metrics.png 345w, /assets/r/381/bbc-news-mvt-dom-metrics.png 381w, /assets/r/384/bbc-news-mvt-dom-metrics.png 384w, /assets/r/546/bbc-news-mvt-dom-metrics.png 546w, /assets/r/640/bbc-news-mvt-dom-metrics.png 640w, /assets/r/738/bbc-news-mvt-dom-metrics.png 738w, /assets/r/840/bbc-news-mvt-dom-metrics.png 840w, /assets/r/960/bbc-news-mvt-dom-metrics.png 960w, /assets/r/1250/bbc-news-mvt-dom-metrics.png 1250w"> <div class="c-gl caption"> <small><i>A chart showing a reduction in load time, DOM ready time, and DOM content loaded time</i></small> </div> </div> <h2 id="wrapping-up">Wrapping up</h2> <p>Taking the time to A/B test performance optimisations can help your team prioritise work and ensure that you don&#x2019;t waste time making optimisations that have no impact. You don&#x2019;t need to use complex or expensive software to get meaningful results from your tests &#x2014; it&#x2019;s probably sufficient to make optimisations by hand and measure the results using free software like WebPagetest or your browser developer tools.</p> </article> <div class="wrap pt-4"> <p> <i>Have any questions or comments? Feel free to reach out on Twitter: <a href="https://twitter.com/Joseph_Wynn">@Joseph_Wynn</a></i> </p> <small> <blockquote> <p>This post was published on <b>20 May, 2016</b> and last updated on <b>8 August, 2018</b>. It was posted in [<a href="/category/BBC News/">BBC News</a>, <a href="/category/Performance/">Performance</a>] and tagged with [<a href="/tag/performance/">performance</a>, <a href="/tag/bbc news/">bbc news</a>, <a href="/tag/ab testing/">ab testing</a>, <a href="/tag/mvt/">mvt</a>] </p> </blockquote> </small> </div> <footer class="wrap mw-w mt-5 pt-4"> <ul class="ls-n f-r"> <li> <a href="https://github.com/wildlyinaccurate"> <span class="d-ib va-m w-4 h-4"> <svg viewbox="0 0 16 16"> <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/> </svg> </span> <span>wildlyinaccurate</span> </a> </li> <li> <a href="https://twitter.com/joseph_wynn"> <span class="d-ib va-m w-4 h-4"> <svg viewbox="0 0 16 16"> <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                        c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/> </svg> </span> <span>joseph_wynn</span> </a> </li> </ul> <small> <i>A collection of guides &amp; opinions about programming and the state of the web. </i> </small> </footer> <script> if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/service-worker.js')
            }

            
            window.LUX = {
                label: 'article'
            } </script> <script src="https://cdn.speedcurve.com/js/lux.js?id=73376842" async defer="defer"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-20744182-3', { siteSpeedSampleRate: 100 });
            ga('send', 'pageview'); </script> <script> (function() {
                var s, p, n, a;

                s = document.createElement('script');
                s.async = 1;
                s.defer = 1;
                s.src = 'https://cdn.carbonads.com/carbon.js?zoneid=1673&serve=C6AILKT&placement=wildlyinaccuratecom';
                s.id = '_carbonads_js';

                p = document.createElement('small');
                p.className = 'ta-c';
                p.appendChild(s);

                n = document.querySelector('article > p:nth-of-type(3)');

                if (n) {
                    n.parentNode.insertBefore(p, n.nextSibling);
                } else {
                    n = document.getElementsByTagName('article')[0];
                    n.parentNode.insertBefore(p, n.nextSibling);
                }
            })(); </script> </body> </html> 